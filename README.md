# 応用心理学Ⅰ「データ収集後探索的解析（テキストマイニング）」講義資料

## 概要

2019.07.13に島根大学人間科学部にて行われた「応用心理学Ⅰ：データ収集後探索的解析（テキストマイニング）」の講義資料です。

講義で使用したスライド、分析のデータよびソースコードを公開しています。



## ファイルについて

### ファイル一覧

+ slide.pdf
    + 講義で使用したスライド
+ Lecture1.ipynb / Lecture1.r
    + R操作の基礎
+ Lecture2.ipynb / Lecture2.r
    + 実習①：夏目漱石「夢十夜」の分析
+ Lecture3.ipynb / Lecture3.r
    + 実習②：夏目漱石『こころ』の分析

+ data/
    + 分析のデモに使ったデータセット
+ dict/
    + MeCab用追加辞書のサンプル
+ functions
    + 実習内で使った自作関数
+ README.md
    + このファイル

### 分析用コード

実習の３つのパートについてLecure1~Lecure3という名前のrファイル(.r)とipynbファイル(.ipynb)があります。

+ ipynbはJupyterLab(JupyterNotebook)で作成されたファイルで、GitHub上でソースコードとその実行結果をみることができます。
+ rファイルはRのソースコードで、より詳しいコードの解説と、ネットワークグラフ用のソースコードが入っています。一行ずつ実行していくことで、分析を再現できます

### ソースコードの実行について

1. GitHubからzipファイルをダウンロードする
1. zipファイルをを解凍する
1. Rを起動する
    + (RStudioで分析する場合)
        + RStudioでフォルダ内のrファイルを開く 
    + (Rで分析する場合)
        + Rを起動する
1. 解凍したフォルダを作業フォルダに設定する
    + setwd(解凍先のフォルダのパス)を実行する。フォルダのパスは以下のいずれかの方法で取得することができる
        + アドレスバーを右クリックして「アドレスのコピー」を選択
        + フォルダを右クリック→プロパティ。表示される「場所」の内容をコピー
        + 好きなフォルダの配下(e.g. C:\\User\Documents)にフォルダを移動する
    + setwd()実行後、getwd()を実行して、うまくフォルダが設定されていることを確認する
1. ひとつずつコードを実行して確認する

### 分析データについて

実習には夏目漱石「夢十夜」および夏目漱石『こころ』本文を分析用に編集したものを用いた。

いずれもパブリックドメインの作品として青空文庫にて公開されているデータを用いた。



## RStudioについて

### コードの実行について

RStudioではsource上で「Ctrl+Enter」(Windowsの場合)を押下するとコードを実行することができます。挙動は、

+ コード選択時：選択されているコードを実行
+ コード非選択時：カーソルのある行を実行

で、実行結果はconsole内に表示されます。

RStudioを用いて分析を行う際は、コードの編集等の作業はsource上でを行うことを<u>**強く推奨します**</u>。

毎回コンソールに打ち込む方式ではコードの変更もいちいち面倒ですし、何らかの理由でRのセッションが再起動した際に内容がすべて失われ、コードの保存もおろそかになってしまいます。課題レポートでは<u>**分析用のソースコードの提出が必須になっている**</u>ことを忘れないでください。



### 不具合について

RStudioについて、何人かの受講生から不具合の連絡が来ています。

+ RStudioが起動せず、真っ白な画面のまま
+ plot系の関数を実行してもエラーが出て表示されない

この件について、<u>ユーザ名に全角文字が含まれている</u>場合にRStudioが不具合を起こすケースがあるようです。



+ problem with plot function 
    https://support.rstudio.com/hc/en-us/community/posts/203375017-problem-with-plot-function


~~もし解決策が見つかりましたらお知らせしますが、見つからなくても大丈夫なよう各自分析を進めてください（RStudioが動作しなくてもR上で分析は実行可能です）。~~　以下に追記しました。

#### 対応策(2019.07.24追記)

ざっくり言って現状の解決策は２つあります。

##### 解決策①　新しいユーザを作成する

ユーザ名に全角文字が含まれることが不具合の原因であるとため、<u>**半角英数字の名前**</u>で新しいユーザを作成し、そのユーザでログインしてRStudioを実行します。
ユーザの作り方については下記リンクを参照してください。

+ Windows 10 でローカルのユーザー アカウントまたは管理者アカウントを作成する
https://support.microsoft.com/ja-jp/help/4026923/windows-10-create-a-local-user-or-administrator-account



##### 解決策②　R単体で作業する

RStudio上の不具合のため、RStudioが動かなくてもR単体でも分析を進めることができます（煩雑ですが）。



いずれの解決策でもうまくいかない場合は別途対応します。



## 課題について


### ヒント

#### クリーニング

以下の事実に留意する

+ 残された時間で<u>すべてのデータを完璧にクリーニングすることは**不可能**である</u>
    + かろうじて１班分のデータぐらいなら人手でも可能かもしれない（試してみても構わない）
    + データが10倍、100倍あっても同じ方法をとるか（とりうるか）を考える
+ データの大部分は<u>分析と関係がない</u>
    + とはいえ事前にどこが重要か知るのも難しい
    + Zipfの法則/Paretoの法則を思い出す
+ データのクリーニングそのものは<u>本来の目的ではない</u>
    + あくまで分析が主目的であることを忘れない
    + 「無難なアプローチ」を思い出す


#### 前処理

##### 特定のデータを除外する

filter()を使ってそれ以外のものを抽出する

```R
library('dplyr')
ToothGrowth %>% filter(supp != 'OJ')  # supp列の値がOJではないものを抽出する
```

##### 括弧の中身を除外する

str_replace()を使う
```R
library('stringr')
text = 'この授業は「応用心理学Ⅰ：データ収集後探索的解析（テキストマイニング）」です'
text %>% str_replace('（[^）]*）', '') # 正規表現にマッチした部分を除去する
# [^）]* : 閉じ括弧以外の任意の文字の連続

```

## Further Reading

+ テキストマイニング

    + 石田基弘『Rによるテキストマイニング』
        + 実習パートの基礎的な部分および環境構築については本書を参考にした。RMeCab内の関数についても詳しく紹介されているほか、講義で紹介したバイグラムによる分析以外にも対応分析(Corresponding Analysis)やワードクラウド、APIを用いたTwitterへのアクセスなどの事例が紹介されている。
    + Silge & Robinson『Rによるテキストマイニング ―tidytextを活用したデータ分析と可視化の基礎』
        + Rを用いた英文テキストマイニングについての本。整然データ tidy dataとしてテキストを扱えるtidytextパッケージを用いた様々な分析法(e.g. トピックモデル)を紹介しているほか、データハンドリングについても内容を多く割いている。

+ 自然言語処理

    + 奥野・ニュービッグ・荻原（著）小町（監修）『自然言語処理の基本と技術』
        + 自然言語処理とはなにか、実社会でどのように使われているかを概説した本。技術的な詳細が少ないので全体を概観するのによい。
    + Bird, Klein, & Loper『入門　自然言語処理』
        + 自然言語処理の基本についてPythonコードを用いて解説している。英語のテキストが対象のため、そのまま日本語の処理に転用することはできないが、基本的な概念を学ぶのによい。ただしPythonコードが若干古い。
    + 高村大地『言語処理のための機械学習入門』
        + 自然言語を機械で処理するための理論的準備をするための本。数式が多いので苦手な人にはとっつきづらいかもしれない。最適化や情報量といった基礎的な内容への解説もあり、数理的な側面を学ぶのによい。

+ 研究におけるバイアス

    + サルガニック『ビット・バイ・ビット ―デジタル社会調査入門』

        + いかにビッグデータを手に入れ、扱い、分析するかといった入門だけでなく、近年のビッグデータを扱った社会科学分野のレビューにもなっている本。特にビッグデータを扱う際の落とし穴について丁寧に書かれているところが素晴らしい。講義中に詳しく紹介する時間がなかったが、「研究倫理」についても多くのページが割かれている。

    + Rothman『ロスマンの疫学―科学的思考への誘い』

        + 疫学 epidemiologyの初歩的な入門書。医学研究における研究デザイン・分析法について解説している。心理学ではあまり聞きなれないタイプの情報バイアス、誤分類 misclassificationなどについても解説がある。本当はこの本よりはSteiner & Norman『論文が読める!早わかり疫学―研究デザインとその評価』の方がとっつきやすいが、残念ながら絶版。

            

## Changes



+ 2019.07.24
    + RStudioの不具合について追記
    + Further Readingを追記
+ 2019.07.17
    + 解説用Rコードを追加
    + READMEをアップデート
+ 2019.07.14 
    + スライドを追加
+ 2019.07.13
    + ipynbファイルを追加

